/**** @Version: 1.0** @Date: 7/4/2022** @Dev: 67562**/--EXEC sp_SearchByCategory 2003;/** Fet all the products based on Ctaegory Name or Product Name **//** IF SP EXISTS then we delete it **/USE [db_shopon]GOIF EXISTS(	SELECT 1 FROM sys.objects WHERE type = 'P' AND OBJECT_ID = OBJECT_ID('[dbo].[sp_SearchByCategory]'))BEGIN	DROP PROC [dbo].[sp_SearchByCategory]ENDGOCREATE PROC [dbo].[sp_SearchByCategory]	@categoryID INT = nullASBEGIN	DECLARE		@productView TABLE		(			Pid INT,			ProductName VARCHAR(20),			Price FLOAT,			ImageUrl VARCHAR(50),			AvailableStatus CHAR(1),			ComapanyID INT,			CompanyName VARCHAR(20),			CategoryID INT,			CategoryName VARCHAR(20)		)		IF (@categoryID IS NULL)		BEGIN			INSERT INTO @productView			SELECT				p.pid, p.productname, p.price, p.imageUrl, p.availablestatus,				co.companyid, co.companyname, ct.categoryid, ct.category			FROM dbo.product AS p WITH(NOLOCK)				INNER JOIN dbo.company AS co WITH(NOLOCK)					ON p.companyid = co.companyid				INNER JOIN dbo.category AS ct WITH(NOLOCK)					ON p.categoryid = ct.categoryid			WHERE 				p.isDeleted = 0		END	ELSE 		BEGIN			INSERT INTO @productView			SELECT				p.pid, p.productname, p.price, p.imageUrl, p.availablestatus,				co.companyid, co.companyname, ct.categoryid, ct.category			FROM dbo.product AS p WITH(NOLOCK)				INNER JOIN dbo.company AS co WITH(NOLOCK)					ON p.companyid = co.companyid				INNER JOIN dbo.category AS ct WITH(NOLOCK)					ON p.categoryid = ct.categoryid			WHERE 				p.isDeleted = 0 AND				ct.categoryid = @categoryID		 END    SELECT * FROM @productViewEND